# https://docs.netlify.com/configure-builds/file-based-configuration/
# Settings in the [build] context are global and are applied to
# all contexts unless otherwise overridden by more specific contexts.
[build]
# Directory that contains the deploy-ready HTML files and
# assets generated by the build. This is relative to the base
# directory if one has been set, or the root directory if
# a base has not been set. This sample publishes the directory
# located at the absolute path "root/project/build-output"

publish = "public/"

# Default build command.
command = "yarn build"

# Ignore builds on Netlify
ignore = "node scripts/ignoreNetlifyBuilds.js"

[build.environment]
NETLIFY_SKIP_GATSBY_FUNCTIONS = "true"
GATSBY_URL = "https://www.literat.dev"
YARN_CHECKSUM_BEHAVIOR = "ignore"
YARN_FLAGS = "--immutable"

[context.deploy-preview]
# Deploy preview only if there are changes in some directories
ignore = "git diff --quiet $CACHED_COMMIT_REF $COMMIT_REF ./src/ ./functions/"

[functions]
# Sets a custom directory for Netlify Functions
directory = "functions/"

node_bundler = "esbuild"

[functions.social-image]
external_node_modules = ["@sparticuz/chromium"]
